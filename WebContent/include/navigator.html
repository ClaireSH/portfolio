<!-- js로 load시킨 문서는 head정보가 별개, include  -->
<meta charset="UTF-8">

<!-- Navigation -->
<nav class="navbar navbar-default navbar-static-top" role="navigation" style="margin-bottom: 0">
	<div class="navbar-header">
		<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
			<span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span>
		</button>
		<a class="navbar-brand" href="main.action">Cover Me :: 엔진v1.78</a>
	</div>
	<!-- /.navbar-header -->

	<ul class="nav navbar-top-links navbar-right">
		<li class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#"> <i class="fa fa-envelope fa-fw"></i> <i class="fa fa-caret-down"></i>
		</a>
			<ul class="dropdown-menu dropdown-messages">
				<li><a href="#">
						<div>
							<strong>user이름</strong> <span class="pull-right text-muted"> <em>Yesterday</em>
							</span>
						</div>
						<div>안녕? 니 포트폴리오 열람권한 좀 주라</div>
				</a></li>
				<li class="divider"></li>
				<li><a class="text-center" href="#"> <strong>전체쪽지</strong> <i class="fa fa-angle-right"></i>
				</a></li>
			</ul> <!-- /.dropdown-messages --></li>
		<!-- /.dropdown -->
		<li class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#"> <i class="fa fa-tasks fa-fw"></i> <i class="fa fa-caret-down"></i>
		</a>
			<ul class="dropdown-menu dropdown-tasks">
				<li><a href="#">
						<div>
							<p>
								<strong>이력서</strong> <span class="pull-right text-muted">40% 완료</span>
							</p>
							<div class="progress progress-striped active">
								<div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="40" aria-valuemin="0" aria-valuemax="100" style="width: 40%">
									<span class="sr-only">40% Complete (success)</span>
								</div>
							</div>
						</div>
				</a></li>
				<li class="divider"></li>
				<li><a href="#">
						<div>
							<p>
								<strong>자기소개</strong> <span class="pull-right text-muted">20% 완료</span>
							</p>
							<div class="progress progress-striped active">
								<div class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="20" aria-valuemin="0" aria-valuemax="100" style="width: 20%">
									<span class="sr-only">20% Complete</span>
								</div>
							</div>
						</div>
				</a></li>

				<li class="divider"></li>
				<li><a class="text-center" href="#"> <strong>전체 완성률 보기</strong> <i class="fa fa-angle-right"></i>
				</a></li>
			</ul> <!-- /.dropdown-tasks --></li>
		<!-- /.dropdown -->
		<li class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#"> <i class="fa fa-bell fa-fw"></i> <i class="fa fa-caret-down"></i>
		</a>
			<ul class="dropdown-menu dropdown-alerts">
				<li><a href="#">
						<div>
							<i class="fa fa-comment fa-fw"></i> 새댓글 <span class="pull-right text-muted small">4 minutes ago</span>
						</div>
				</a></li>
				<li class="divider"></li>
				<li><a href="#">
						<div>
							<i class="fa fa-tasks fa-fw"></i> 새 포트폴리오 <span class="pull-right text-muted small">4 minutes ago</span>
						</div>
				</a></li>
				<li class="divider"></li>
				<li><a href="#">
						<div>
							<i class="fa fa-upload fa-fw"></i> 커버 다운로드 <span class="pull-right text-muted small">4 minutes ago</span>
						</div>
				</a></li>
				<li class="divider"></li>
				<li><a class="text-center" href="#"> <strong>사용자 알림가기</strong> <i class="fa fa-angle-right"></i>
				</a></li>
			</ul> <!-- /.dropdown-alerts --></li>
		<!-- /.dropdown -->
		<li class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#"> <i class="fa fa-user fa-fw"></i> <i class="fa fa-caret-down"></i>
		</a>
			<ul class="dropdown-menu dropdown-user">
				<li><a href="#"><i class="fa fa-user fa-fw"></i> 내 프로필</a></li>
				<li><a href="#"><i class="fa fa-gear fa-fw"></i> 설정</a></li>
				<li class="divider"></li>
				<li><a href="logout.action"><i class="fa fa-sign-out fa-fw"></i> 로그아웃</a></li>
			</ul> <!-- /.dropdown-user --></li>
		<!-- /.dropdown -->
	</ul>
	<!-- /.navbar-top-links -->

	<div class="navbar-default sidebar" role="navigation">
		<div class="sidebar-nav navbar-collapse">
			<ul class="nav" id="side-menu">
				<li class="sidebar-search">
					<div class="input-group custom-search-form">
						<input type="text" class="form-control" placeholder="Search..."> <span class="input-group-btn">
							<button class="btn btn-default" type="button">
								<i class="fa fa-search"></i>
							</button>
						</span>
					</div> <!-- /input-group -->
				</li>
				<li><a href="main.action"><i class="fa fa-dashboard fa-fw"></i> 한눈보기</a></li>


				<li><a href="#"><i class="fa fa-comments fa-fw"></i> 질문답변<span class="fa arrow"></span></a>
					<ul class="nav nav-second-level">
						<li><a href="qnaEdit.action"><i class="fa  fa-table fa-fw"></i> 질문편집</a></li>
						<li><a id="answering" href="#qnaModal" data-toggle="modal" data-dismiss="modal"><i class="fa fa-edit fa-fw"></i> 답변하기</a></li>
					</ul> <!-- /.nav-second-level --></li>



				<li><a href="#"><i class="fa fa-files-o fa-fw"></i> 포트폴리오<span class="fa arrow"></span></a>
					<ul class="nav nav-second-level">
						<li><a href="goUpdateMemberForm.action"><i class="fa fa-user fa-fw"></i> 프로필커버</a></li>
						<li><a href="goUpdateResumeForm.action"><i class="fa fa-th-list fa-fw"></i> 이력서커버</a></li>
						<li><a href="cvWrite.action"><i class="fa fa-columns   fa-fw"></i> 자기소개커버</a></li>
					</ul> <!-- /.nav-second-level --></li>
				<li><a href="#"><i class="fa fa-bar-chart-o fa-fw"></i> 분석<span class="fa arrow"></span></a>
					<ul class="nav nav-second-level">
						<li><a href="analy_str.action"><i class="fa  fa-list-ol fa-fw"></i> 순위분석</a></li>
						<li><a href="analy_num.action"><i class="fa fa-bar-chart-o fa-fw"></i> 추이분석</a></li>
					</ul> <!-- /.nav-second-level --></li>
				<li><a href="#"><i class="fa fa-wrench fa-fw"></i>개발자도구(개발자용)<span class="fa arrow"></span></a>
					<ul class="nav nav-second-level">
						<li><a href="panels.action">Panels and Wells</a></li>
						<li><a href="buttons.action">Buttons</a></li>
						<li><a href="notifications.action">Notifications</a></li>
						<li><a href="typography.action">Typography</a></li>
						<li><a href="icons.action"> Icons</a></li>
						<li><a href="grid.action">Grid</a></li>
					</ul> <!-- /.nav-second-level --></li>


			</ul>
		</div>
		<!-- /.sidebar-collapse -->
	</div>
	<!-- /.navbar-static-side -->
</nav>
<!-- jQuery -->
<script src="/portfolio/vendor/jquery/jquery.min.js"></script>

<!-- Bootstrap Core JavaScript -->
<script src="/portfolio/vendor/bootstrap/js/bootstrap.min.js"></script>

<!-- Metis Menu Plugin JavaScript -->
<script src="/portfolio/vendor/metisMenu/metisMenu.min.js"></script>

<!-- Custom Theme JavaScript -->
<script src="/portfolio/dist/js/sb-admin-2.js"></script>


<!-- 회원가입 -->
<!-- 질문답변 모달 -->
<div id="qnaModal" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-body">
				<div class="chat-panel panel panel-default">
					<div class="panel-heading">
						<i class="fa fa-comments fa-fw"></i> 질문답변
						<div class="btn-group pull-right">
							<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown">
								<i class="fa fa-chevron-down"></i>
							</button>
							<ul class="dropdown-menu slidedown">
								<li><a href="#"> <i class="fa fa-refresh fa-fw"></i> 질문바꾸기
								</a></li>
								<li><a href="#"> <i class="fa fa-check-circle fa-fw"></i> 전송하기
								</a></li>
								<li class="divider"></li>
								<li><a href="#" data-dismiss="modal"> <i class="fa fa-times fa-fw"></i> 나가기
								</a></li>
							</ul>
						</div>
					</div>
					<!-- /.panel-heading -->
					
					<script>
					
						$(document).ready(
								function() {
	
									//초기 질문 목록 받아오기
										$.ajax({
											url : 'initQna',
											type : 'post',
											success : function(data) {
				
												
												var qList_len = data.qList.length;
												var aList_len = data.aList.length;
												
												if(aList_len == null){
													//질문만 보여준다.
													$('.chat').append(
															'<li class="left clearfix"><span class="chat-img pull-left">'+
															'<img src="/portfolio/include/img/icon_circle_design.png" alt="User Avatar" class="img-circle" />'+
															'</span>'+
															'<div class="chat-body clearfix">'+
															'<div class="header">'+
															'<strong class="primary-font">'+ data.qList[0].questionType + '</strong>'+
															'<small class="pull-right text-muted"><i class="fa fa-clock-o fa-fw"></i>'+ 
															data.qList[0].questionId + '/' + (parseInt(qList_len) - 1) +'번째 질문'+
															'</small>'+
															'</div>'+
															'<p>'+ data.qList[0].question +'</p>'+
															'</div></li>').children("li:last").fadeIn(500);
													
												}else{
													for(var i=0;i<aList_len;i++){
														//질문
														$('.chat').append(
																'<li class="left clearfix"><span class="chat-img pull-left">'+
																'<img src="/portfolio/include/img/icon_circle_design.png" alt="User Avatar" class="img-circle" />'+
																'</span>'+
																'<div class="chat-body clearfix">'+
																'<div class="header">'+
																'<strong class="primary-font">'+ data.qList[i].questionType + '</strong>'+
																'<small class="pull-right text-muted"><i class="fa fa-clock-o fa-fw"></i>'+ 
																data.qList[i].questionId + '/' + (parseInt(qList_len) - 1) +'번째 질문'+
																'</small>'+
																'</div>'+
																'<p>'+ data.qList[i].question +'</p>'+
																'</div></li>').children("li:last").fadeIn(500);
														
														//답변
														$('.chat').append(
																'<li class="right clearfix">'+
																'<span class="chat-img pull-right"> </span>'+
																'<div class="clearfix">'+
																'<div class="header">'+
																'<small class=" text-muted"> <i class="fa fa-clock-o fa-fw"></i></small>'+
																'<strong class="pull-right primary-font">'+ data.aList[i].questionId +'번째 답변</strong>'+
																'</div> <p>' + data.aList[i].answer + '</p> </div></li>').children("li:last").fadeIn(500);
														
													}
												}
												//답변된 수 만큼 질문과 답변을 돌림
												
												
												if(qList_len <= aList_len){
													//질문 수와 답변 수가 같으면 질문은 출력하지 않는다(완료)
												}else{
													//질문 수(6)와 답변 수(5)가 다르면, 다음 질문을 보여준다.
													$('.chat').append(
															'<li class="left clearfix"><span class="chat-img pull-left">'+
															'<img src="/portfolio/include/img/icon_circle_design.png" alt="User Avatar" class="img-circle" />'+
															'</span>'+
															'<div class="chat-body clearfix">'+
															'<div class="header">'+
															'<strong class="primary-font">'+ data.qList[aList_len].questionType + '</strong>'+
															'<small class="pull-right text-muted">'+
															'<i class="fa fa-clock-o fa-fw"></i>'+ data.qList[aList_len].questionId + '/' + (parseInt(qList_len) - 1) +'번째 질문'+
															'</small>'+
															'</div>'+
															'<p>'+ data.qList[aList_len].question +'</p>'+
															'</div></li>').children("li:last").fadeIn(500);
												}
							
											}
										});//ajax

									

									//답변전송
									$('#btn-chat').click(
											
											function() {
												console.log('btn-chat');
												$.ajax({
													url : 'insertAnswer',
													type : 'post',
													data : {
														
														"answerVo.answer" : $('#btn-input').val()
													},

													success : function(data) {
														
														var qList_len = data.qList.length;
														var aList_len = data.aList.length;
														
														//alert(parseInt(qList_len) +""+ parseInt(aList_len-1));
														$('#btn-input').val('');
														
														if(parseInt(qList_len) <= parseInt(aList_len)){
															//질문 수와 답변 수가 같으면, 다음 질문(null)에 답변(null)할 수 없음
															
															alert('더 이상 답변 할 수 없습니다.');
														}else if( parseInt(qList_len) <= parseInt(aList_len-1)){
															//마지막 질문에 대한 답변 처리
															$('.chat').append(
																	'<li class="right clearfix">'+
																	'<span class="chat-img pull-right"> </span>'+
																	'<div class="clearfix">'+
																	'<div class="header">'+
																	'<small class=" text-muted"> <i class="fa fa-clock-o fa-fw"></i> 20분 전 </small>'+
																	'<strong class="pull-right primary-font">'+ data.answerVo.questionId +'번째 답변</strong>'+
																	'</div> <p>' + data.answerVo.answer + '</p> </div></li>').children("li:last").fadeIn(500);
														}else{
															//답변
															$('.chat').append(
																	'<li class="right clearfix">'+
																	'<span class="chat-img pull-right"> </span>'+
																	'<div class="clearfix">'+
																	'<div class="header">'+
																	'<small class=" text-muted"> <i class="fa fa-clock-o fa-fw"></i> 20분 전 </small>'+
																	'<strong class="pull-right primary-font">'+ data.answerVo.questionId +'번째 답변</strong>'+
																	'</div> <p>' + data.answerVo.answer + '</p> </div></li>').children("li:last").fadeIn(500);
															//질문
															$('.chat').append(
																	'<li class="left clearfix">'+
																	'<span class="chat-img pull-left"> <img src="/portfolio/include/img/icon_circle_design.png" alt="User Avatar" class="img-circle" /> </span>'+
																	'<div class="chat-body clearfix">'+
																	'<div class="header">'+
																	'<strong class="primary-font">[' + data.questionVo.questionType + ']</strong>'+
																	'<small class="pull-right text-muted"> <i class="fa fa-clock-o fa-fw"></i> ' + data.questionVo.questionId + '/' + parseInt(qList_len-1) +'번째 질문 </small>'+
																	'</div> <p>' + data.questionVo.question + '</p> </div></li>').children("li:last").fadeIn(500);
														}
														
													}
												});//ajax

											});//click

								});//ready								
					</script>
					
					<div class="panel-body" id="panel-body">
						
						<ul class="chat">
						
						<!-- 패널  -->
						
						</ul> 
						
					</div>
					<!-- /.panel-body -->
		
					<div class="panel-footer">
						<div class="input-group">
							<input id="btn-input" type="text" class="form-control input-sm" name="qna.answer" placeholder="답변을 입력해주세요" /> <span class="input-group-btn">
								<button class="btn btn-warning btn-sm" id="btn-chat" >보내기</button>

							</span>
						</div>
					</div>
					<!-- /.panel-footer -->
				</div>
				<!-- /.panel .chat-panel -->
			</div>
		</div>
	</div>
</div>

<!--  -->
